<launch>
  <arg name="fast_mode" default="false"/>
  <arg name="node_start_delay" default="4.0"/>
  <arg name="num_closest_agents" default="5"/>

  <arg name="scene_file" default="$(find pedsim_simulator)/scenarios/lobby/eng_hall_25.xml"/>
  <arg name="world_name" default="$(find robot_gazebo)/worlds/gazebo_eng_lobby.world"/>
  <arg name="gui" default="true" doc="Bring up the Gazebo graphical interface"/>
  <!-- lobby: (1,1); square: (1,1); cumberland: (4,8); autolab: (1,8); freiburg: (3,17) -->
  <arg name="pose_initial_x" default="1"/>
  <arg name="pose_initial_y" default="1"/>
  <arg name="map_file" default="$(find robot_gazebo)/maps/gazebo_eng_lobby/old/gazebo_eng_lobby.yaml"/>
  <arg name="initial_pose_x" default="1.0"/>
  <arg name="initial_pose_y" default="0.0"/>
  <arg name="initial_pose_a" default="0.13"/>

  <!-- Use sim time for simulator -->
  <param name="/use_sim_time" value="true"/>

  <include file="$(find pedsim_simulator)/launch/robot.launch">
    <arg name="scene_file" value="$(arg scene_file)"/>
    <arg name="world_name" value="$(arg world_name)"/>
    <arg name="gui" value="$(arg gui)"/>
    <arg name="pose_initial_x" value="$(arg pose_initial_x)"/>
    <arg name="pose_initial_y" value="$(arg pose_initial_y)"/>
  </include>

  <include file="$(find pedsim_cohan)/launch/include/amcl_pedsim.launch">
    <arg name="map_file" value="$(arg map_file)"/>
    <arg name="initial_pose_x" value="$(arg initial_pose_x)"/>
    <arg name="initial_pose_y" value="$(arg initial_pose_y)"/>
    <arg name="initial_pose_a" value="$(arg initial_pose_a)"/>
  </include>


<!-- Launch the cohan navigation node for robot along with the supporting nodes -->

  <include file="$(find pedsim_cohan)/launch/include/agent_tracking.launch">
    <arg name="num_closest_agents" value="$(arg num_closest_agents)"/>
  </include>

  <include file="$(find pedsim_cohan)/launch/include/cohan_move_base.launch">
    <arg name="node_start_delay" value="$(arg node_start_delay)"/>
    <arg name="cmd_vel_topic" value="/cmd_vel_mux/input/navi" />
  </include>
  
  <node pkg="invisible_humans_detection" type="invisible_humans_detection_node" name="map_scanner" output="screen"/>


  <!-- Rviz -->
  <node name="rviz" pkg="rviz" type="rviz" args="-d $(find pedsim_cohan)/rviz/pedsim_cohan.rviz" />

  <node name="goal_distance_checker" pkg="flownav_pkg" type="reached_goal_tf.py"/>

</launch>
